<style>
  .credentials-form {
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding: 16px;
  }
  .form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .form-group label {
    font-weight: bold;
  }
  .form-group input {
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  .error-message {
    color: red;
    margin-top: 8px;
    display: none;
  }
  .button-container {
    display: flex;
    justify-content: flex-end;
    margin-top: 16px;
  }
</style>

<div class="credentials-form">
  <div class="form-group">
    <label for="clientId">Client ID</label>
    <input type="text" id="clientId" placeholder="Enter your Enode API Client ID" />
  </div>
  <div class="form-group">
    <label for="clientSecret">Client Secret</label>
    <input type="password" id="clientSecret" placeholder="Enter your Enode API Client Secret" />
  </div>
  <div class="error-message" id="error"></div>
  <div class="button-container">
    <button id="submit" class="homey-button-primary">Continue</button>
  </div>
</div>

<script type="text/javascript">
Homey.setTitle('Enter Enode API Credentials');

document.getElementById('submit').addEventListener('click', function() {
  const clientId = document.getElementById('clientId').value;
  const clientSecret = document.getElementById('clientSecret').value;
  const errorElement = document.getElementById('error');

  if (!clientId || !clientSecret) {
    errorElement.textContent = 'Please enter both Client ID and Client Secret';
    errorElement.style.display = 'block';
    return;
  }

  Homey.emit('credentials', { clientId, clientSecret })
    .then(function(result) {
      if (result) {
        Homey.showView('list_devices');
      }
    })
    .catch(function(error) {
      errorElement.textContent = error.message || 'Invalid credentials';
      errorElement.style.display = 'block';
    });
});
